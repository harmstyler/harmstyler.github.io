<!doctype html><html lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="KNP Menu is a library by the guys at KNP Labs for building menus with php. The KNP menu library offers great features like automatically adding branch classes, marking the first and last item in a menu, and provides features for to automatically figure out the current menu item. Adding raw html into a label (eg <br>) can be a bit of a pain, however."><link rel=canonical href=https://harmstyler.me/posts/2015/raw-html-in-knp-menu-labels/><title>Allowing Raw HTML in KNP Menu Labels &#183; Tyler Harms</title><meta name=twitter:card content="summary"><meta name=twitter:title content="Allowing Raw HTML in KNP Menu Labels"><meta name=twitter:description content="KNP Menu is a library by the guys at KNP Labs for building menus with php. The KNP menu library offers great features like automatically adding branch classes, marking the first and last item in a menu, and provides features for to automatically figure out the current menu item. Adding raw html into a label (eg <br>) can be a bit of a pain, however."><meta property="og:url" content="https://harmstyler.me/posts/2015/raw-html-in-knp-menu-labels/"><meta property="og:site_name" content="Tyler Harms"><meta property="og:title" content="Allowing Raw HTML in KNP Menu Labels"><meta property="og:description" content="KNP Menu is a library by the guys at KNP Labs for building menus with php. The KNP menu library offers great features like automatically adding branch classes, marking the first and last item in a menu, and provides features for to automatically figure out the current menu item. Adding raw html into a label (eg <br>) can be a bit of a pain, however."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-07-20T00:00:00+00:00"><meta property="article:modified_time" content="2015-07-20T00:00:00+00:00"><meta property="article:tag" content="KNP Menu"><meta itemprop=name content="Allowing Raw HTML in KNP Menu Labels"><meta itemprop=description content="KNP Menu is a library by the guys at KNP Labs for building menus with php. The KNP menu library offers great features like automatically adding branch classes, marking the first and last item in a menu, and provides features for to automatically figure out the current menu item. Adding raw html into a label (eg <br>) can be a bit of a pain, however."><meta itemprop=datePublished content="2015-07-20T00:00:00+00:00"><meta itemprop=dateModified content="2015-07-20T00:00:00+00:00"><meta itemprop=wordCount content="426"><meta itemprop=keywords content="KNP Menu"><meta name=generator content="Hugo 0.154.5"><meta name=copyright content="Tyler Harms"><meta name=author content="Tyler Harms"><link rel=stylesheet href=https://harmstyler.me/css/syntax.min.526c7855d123d38fb872630d4fd87414145f1c4718e03de5cdec1c1fbdd44f3458c31f6ef3f67ba28a296a00ba072faf897644f22e1360bf7265b512a40017fa.css integrity="sha512-Umx4VdEj04+4cmMNT9h0FBRfHEcY4D3lzewcH73UTzRYwx9u8/Z7ooopagC6By+viXZE8i4TYL9yZbUSpAAX+g==" media=screen><link rel=stylesheet href=/scss/hyde-hyde.51d9e06a8e337f8159a7ffa08e5d6e735ddf5ae6fe9cf8e99fb22367a5fcc195.css integrity="sha256-Udngao4zf4FZp/+gjl1uc13fWub+nPjpn7IjZ6X8wZU="><link rel=stylesheet href=/scss/print.1850a99a7deb72f7243ff99e7a0dfc548ba8837498518c98cc1e44fa65bf1678.css integrity="sha256-GFCpmn3rcvckP/meeg38VIuog3SYUYyYzB5E+mW/Fng=" media=print><link rel=apple-touch-icon sizes=76x76 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#6a9fb5"><meta name=description content="KNP Menu is a library by the guys at KNP Labs for building menus with php. The KNP menu library offers great features like automatically adding branch classes, marking the first and last item in a menu, and provides features for to automatically figure out the current menu item. Adding raw html into a label (eg <br>) can be a bit of a pain, however."></head><body class=theme-base-0d><div class=sidebar><div class=container><div class=sidebar-about><span class=site__title><a href=https://harmstyler.me/>Tyler Harms</a></span><div class=author-image><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src=https://harmstyler.me//img/tyler_portrait.jpg alt="Author Image" class="img--circle img--headshot element--center lazyload"></div><p class=site__description>A Software Development Blog</p></div><div class=collapsible-menu><input type=checkbox id=menuToggle>
<label for=menuToggle>Tyler Harms</label><div class=menu-content><nav class=sidebar-nav aria-label="Main Navigation"><ul><li><a href=/posts/><span>Posts</span></a></li><li><a href=/portfolio/><span>Portfolio</span></a></li><li><a href=/about/><span>About</span></a></li></ul></nav><section class=social><a href=https://indieweb.social/@harmstyler rel="me noopener" aria-label=Mastodon><i class="fab fa-mastodon fa-lg" aria-hidden=true></i></a>
<a href=https://github.com/harmstyler rel="me noopener" aria-label=GitHub><i class="fab fa-github fa-lg" aria-hidden=true></i></a>
<a href=https://gitlab.com/harmstyler rel="me noopener" aria-label=GitLab><i class="fab fa-gitlab fa-lg" aria-hidden=true></i></a>
<a href=https://instagram.com/harmstyler rel="me noopener" aria-label=Instagram><i class="fab fa-instagram fa-lg" aria-hidden=true></i></a>
<a href=https://linkedin.com/in/harmstyler rel="me noopener" aria-label=LinkedIn><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a>
<a href=https://stackoverflow.com/users/743245/harmstyler rel="me noopener" aria-label="Stack Overflow"><i class="fab fa-stack-overflow fa-lg" aria-hidden=true></i></a></section></div></div><div class=copyright>&copy; 2026 Tyler Harms</div></div></div><div class="content container"><article><header><h1>Allowing Raw HTML in KNP Menu Labels</h1><div class=post__meta><i class="fas fa-calendar-alt"></i>&nbsp;Jul 20, 2015
in
<a class="badge badge-category" href=/categories/php>PHP</a>
â€¢
<a class="badge badge-category" href=/categories/symfony>SYMFONY</a><br>&nbsp;<i class="fas fa-tags"></i>
<a class="badge badge-tag" href=/tags/knp-menu>knp menu</a><br><i class="fas fa-clock"></i>&nbsp;2 min read</div></header><div class=post><p><a href=https://github.com/knplabs/KnpMenu>KNP Menu</a> is a library by the guys at <a href=http://knplabs.com>KNP Labs</a> for building menus with php. The KNP menu library offers great features like automatically adding branch classes, marking the first and last item in a menu, and provides features for to automatically figure out the current menu item. Adding raw html into a label (eg <code>&lt;br></code>) can be a bit of a pain, however.</p><p>The KNP menu library offers all the necessary tooling to add raw html into the labels out of the box. There are, however, no examples on the doc pages. Firstly, the menu renderer needs to be told that the menu can have raw html in the labels. Secondly, the menu label needs to be identified as a safe label before the renderer will allow raw html.</p><p>To tell the renderer that the menu can contain raw html, or safe labels as the KNP menu library prefers to call it, the <code>allow_safe_labels</code> renderer option needs to be set to true.</p><p>To set the <code>allow_safe_labels</code> option using the KNPMenu Library:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Knp\Menu\Matcher\Matcher</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Knp\Menu\MenuFactory</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Knp\Menu\Renderer\ListRenderer</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Create the new menu
</span></span></span><span class=line><span class=cl><span class=nv>$factory</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>MenuFactory</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nv>$menu</span> <span class=o>=</span> <span class=nv>$factory</span><span class=o>-&gt;</span><span class=na>createItem</span><span class=p>(</span><span class=s1>&#39;My menu&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$menu</span><span class=o>-&gt;</span><span class=na>addChild</span><span class=p>(</span><span class=s1>&#39;Home&#39;</span><span class=p>,</span> <span class=k>array</span><span class=p>(</span><span class=s1>&#39;uri&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;/&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nv>$menu</span><span class=o>-&gt;</span><span class=na>addChild</span><span class=p>(</span><span class=s1>&#39;Comments&#39;</span><span class=p>,</span> <span class=k>array</span><span class=p>(</span><span class=s1>&#39;uri&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;#comments&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nv>$menu</span><span class=o>-&gt;</span><span class=na>addChild</span><span class=p>(</span><span class=s1>&#39;Symfony2&#39;</span><span class=p>,</span> <span class=k>array</span><span class=p>(</span><span class=s1>&#39;uri&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;http://symfony-reloaded.org/&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Render the menu with the necessary renderer options
</span></span></span><span class=line><span class=cl><span class=nv>$rendererOptions</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;allow_safe_labels&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nv>$renderer</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ListRenderer</span><span class=p>(</span><span class=k>new</span> <span class=nx>Matcher</span><span class=p>(),</span> <span class=nv>$rendererOptions</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$renderer</span><span class=o>-&gt;</span><span class=na>render</span><span class=p>(</span><span class=nv>$menu</span><span class=p>);</span></span></span></code></pre></td></tr></table></div></div><p>Because rendering a menu is done differently using the KNPMenuBundle, the <code>allow_safe_labels</code> option is a is set quite differently:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-twig data-lang=twig><span class=line><span class=cl><span class=cp>{%</span> <span class=k>raw</span> <span class=cp>%}</span><span class=x>
</span></span></span><span class=line><span class=cl><span class=x>{{ knp_menu_render(&#39;primary_menu&#39;, {&#39;allow_safe_labels&#39;: true}) }}
</span></span></span><span class=line><span class=cl><span class=cp>{%</span> <span class=k>endraw</span> <span class=cp>%}</span></span></span></code></pre></td></tr></table></div></div><p>To tell the renderer that menu item contains a safe label, and can thereby be rendered unescaped, an <code>extra</code> parameter needs to be passed.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$menu</span>
</span></span><span class=line><span class=cl>    <span class=o>-&gt;</span><span class=na>addChild</span><span class=p>(</span><span class=s1>&#39;Foo&lt;br&gt;Bar&#39;</span><span class=p>,</span> <span class=k>array</span><span class=p>(</span><span class=s1>&#39;uri&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;/&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=o>-&gt;</span><span class=na>setExtra</span><span class=p>(</span><span class=s1>&#39;safe_label&#39;</span><span class=p>,</span> <span class=k>true</span><span class=p>);</span></span></span></code></pre></td></tr></table></div></div><p>Options set via the <code>setExtra()</code> method end up as options on the menu item, accessible by a <code>getExtra()</code> method. The default twig template for KNPMenuBundle takes advantage of this parameter out of the box.</p><p>In summary, rendering menus using the KNP menu library with raw html in the label is possible without much work. I hope these examples help should you ever find yourself trying put raw html in a label in the future. Know that the barriers are in place for good reason, however, as allowing raw html in your labels could allow some XSS holes to pop up in your application should the menu labels be created by a user.</p></div><div class="navigation navigation-single"><a href=/posts/2014/mixing-angular-and-symfony/ class=navigation-prev><i aria-hidden=true class="fa fa-chevron-left"></i>
<span class=navigation-tittle>Mixing AngularJS and Symfony</span>
</a><a href=/posts/2016/managing-media-in-ez-publish/ class=navigation-next><span class=navigation-tittle>Managing Media in eZ Publish 5</span>
<i aria-hidden=true class="fa fa-chevron-right"></i></a></div><div id=graphcomment></div><script type=text/javascript>window.graphcomment_id="harmstyler-me",function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://graphcomment.com/js/integration.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script></article></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-367546757"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-367546757")}</script><script defer src=https://use.fontawesome.com/releases/v5.5.0/js/all.js integrity=sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0 crossorigin=anonymous></script><script type=text/javascript src=https://harmstyler.me/js/lazysizes.min.64304986998b78c207dc8b4c3da26cc22276e8b0260e7adc7172f39c35686ef216c931ad50af0239886d0d55c2e65f732d51804a62ddf45a686455117060b8e7.js integrity="sha512-ZDBJhpmLeMIH3ItMPaJswiJ26LAmDnrccXLznDVobvIWyTGtUK8COYhtDVXC5l9zLVGASmLd9FpoZFURcGC45w=="></script></body></html>